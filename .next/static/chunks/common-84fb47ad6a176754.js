(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[76],{425:(e,t,a)=>{"use strict";a.d(t,{Eo:()=>d,Ig:()=>u,R2:()=>o,i9:()=>h,ov:()=>c,uE:()=>l});var r=a(3464),s=a(6243),n=a(4732);let i=a(1890).env.NEXT_PUBLIC_API_URL||"http://localhost:8080/api",l=r.A.create({baseURL:i,timeout:1e4,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let t=s.M.getState().auth.token;return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,async e=>{var t;let a=e.config;if((null==(t=e.response)?void 0:t.status)===401&&!a._retry){a._retry=!0;let e=s.M.getState().auth.refreshToken;if(e)try{await s.M.dispatch((0,n.J1)(e));let t=s.M.getState().auth.token;if(t)return a.headers.Authorization="Bearer ".concat(t),l(a)}catch(e){s.M.dispatch((0,n.ri)()),window.location.href="/login"}else s.M.dispatch((0,n.ri)()),window.location.href="/login"}return Promise.reject(e)});let o={login:e=>l.post("/auth/login",e),register:e=>l.post("/auth/register",e),refreshToken:e=>l.post("/auth/refresh",{refreshToken:e}),logout:()=>l.post("/auth/logout")},d={getUsers:e=>l.get("/users",{params:e}),getUser:e=>l.get("/users/".concat(e)),updateUser:(e,t)=>l.put("/users/".concat(e),t),deleteUser:e=>l.delete("/users/".concat(e)),uploadAvatar:(e,t)=>{let a=new FormData;return a.append("avatar",t),l.post("/users/".concat(e,"/avatar"),a,{headers:{"Content-Type":"multipart/form-data"}})}},c={getTasks:e=>l.get("/tasks",{params:e}),getTask:e=>l.get("/tasks/".concat(e)),createTask:e=>l.post("/tasks",e),updateTask:(e,t)=>l.put("/tasks/".concat(e),t),deleteTask:e=>l.delete("/tasks/".concat(e)),claimTask:e=>l.patch("/tasks/".concat(e,"/claim")),completeTask:e=>l.patch("/tasks/".concat(e,"/complete")),approveTask:e=>l.patch("/tasks/".concat(e,"/approve")),rejectTask:(e,t)=>l.patch("/tasks/".concat(e,"/reject"),{reason:t}),assignTask:(e,t)=>l.patch("/tasks/".concat(e,"/assign"),{userId:t}),getTasksByUser:e=>l.get("/users/".concat(e,"/tasks")),getTaskStats:()=>l.get("/tasks/stats"),verifyTask:e=>l.post("/tasks/".concat(e,"/verify"))},u={getPoints:e=>l.get("/points",{params:{userId:e}}),awardPoints:e=>l.post("/points/award",e),getLeaderboard:e=>l.get("/points/leaderboard",{params:{period:e}}),getPointsHistory:e=>l.get("/points/history/".concat(e))},h={getNotifications:e=>l.get("/notifications/".concat(e)),markAsRead:e=>l.put("/notifications/".concat(e,"/read")),markAllAsRead:e=>l.put("/notifications/".concat(e,"/read-all")),deleteNotification:e=>l.delete("/notifications/".concat(e))}},3320:(e,t,a)=>{"use strict";a.d(t,{h:()=>o,p:()=>i});var r=a(5155),s=a(2115);let n=(0,s.createContext)(void 0);function i(e){let{children:t}=e,[a,i]=(0,s.useState)([]),o=(0,s.useCallback)(e=>{let t=Math.random().toString(36).substr(2,9),a={...e,id:t};i(e=>[...e,a]),setTimeout(()=>{d(t)},e.duration||5e3)},[]),d=(0,s.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e))},[]),c=(0,s.useCallback)(()=>{i([])},[]);return(0,r.jsxs)(n.Provider,{value:{notifications:a,addNotification:o,removeNotification:d,clearNotifications:c},children:[t,(0,r.jsx)(l,{})]})}function l(){let{notifications:e,removeNotification:t}=o();return(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(e=>(0,r.jsx)("div",{className:"\n            max-w-sm w-full bg-white shadow-lg rounded-lg pointer-events-auto ring-1 ring-black ring-opacity-5 overflow-hidden\n            ".concat("success"===e.type?"border-l-4 border-green-400":"","\n            ").concat("error"===e.type?"border-l-4 border-red-400":"","\n            ").concat("warning"===e.type?"border-l-4 border-yellow-400":"","\n            ").concat("info"===e.type?"border-l-4 border-blue-400":"","\n          "),children:(0,r.jsx)("div",{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.title}),e.message&&(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:e.message})]}),(0,r.jsxs)("button",{className:"ml-4 flex-shrink-0 text-gray-400 hover:text-gray-500",onClick:()=>t(e.id),children:[(0,r.jsx)("span",{className:"sr-only",children:"关闭"}),(0,r.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]})})},e.id))})}function o(){let e=(0,s.useContext)(n);if(void 0===e)throw Error("useNotification must be used within a NotificationProvider");return e}},3590:(e,t,a)=>{"use strict";a.d(t,{A:()=>l}),a(5155);var r=a(2115);a(5695);var s=a(425);class n{static async login(e){try{let t=await s.uE.post("/auth/login",e);return this.setToken(t.token),this.setUser(t.user),t}catch(e){throw console.error("Login failed:",e),e}}static async register(e){try{let t=await s.uE.post("/auth/register",e);return this.setToken(t.token),this.setUser(t.user),t}catch(e){throw console.error("Registration failed:",e),e}}static async logout(){try{this.getToken()&&await s.uE.post("/auth/logout")}catch(e){console.error("Logout API call failed:",e)}finally{this.clearAuth()}}static async getCurrentUser(){try{let e=await s.uE.get("/auth/me"),t={id:e.user.id,username:e.user.username,email:e.user.email,role:e.user.role,avatar:e.user.avatar_url,totalPoints:0,createdAt:"",updatedAt:""};return this.setUser(t),t}catch(e){return console.error("Failed to get current user:",e),this.clearAuth(),null}}static isAuthenticated(){let e=this.getToken(),t=this.getStoredUser();return!!(e&&t)}static getToken(){return localStorage.getItem(this.TOKEN_KEY)}static getStoredUser(){try{let e=localStorage.getItem(this.USER_KEY);return e?JSON.parse(e):null}catch(e){return console.error("Failed to parse stored user:",e),null}}static setToken(e){localStorage.setItem(this.TOKEN_KEY,e)}static setUser(e){let t={id:e.id,username:e.username,email:e.email,role:e.role,avatar:e.avatarUrl||e.avatar_url,totalPoints:e.totalPoints||0,createdAt:e.createdAt||"",updatedAt:e.updatedAt||""};localStorage.setItem(this.USER_KEY,JSON.stringify(t))}static clearAuth(){localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.USER_KEY)}static isValidTokenFormat(e){return 3===e.split(".").length}static isTokenExpired(e){try{if(!this.isValidTokenFormat(e))return!0;let t=JSON.parse(atob(e.split(".")[1])),a=Math.floor(Date.now()/1e3);return t.exp&&t.exp<a}catch(e){return console.error("Failed to check token expiration:",e),!0}}static async refreshTokenIfNeeded(){let e=this.getToken();return!!e&&(!this.isTokenExpired(e)||(this.clearAuth(),!1))}static async initializeAuth(){let e=this.getToken();return e?this.isTokenExpired(e)?(this.clearAuth(),null):await this.getCurrentUser():null}}n.TOKEN_KEY="authToken",n.USER_KEY="currentUser",new n;let i=(0,r.createContext)(void 0);function l(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},3840:(e,t,a)=>{"use strict";a.d(t,{k:()=>s});var r=a(5155);function s(e){let{size:t="md",className:a=""}=e;return(0,r.jsx)("div",{className:"flex items-center justify-center ".concat(a),children:(0,r.jsx)("div",{className:"".concat({sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"}[t]," animate-spin rounded-full border-2 border-gray-300 border-t-blue-600")})})}},4732:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>h,J1:()=>l,ri:()=>d});var r=a(6439),s=a(425);let n=(0,r.zD)("auth/login",async(e,t)=>{let{rejectWithValue:a}=t;try{return(await s.R2.login(e)).data}catch(e){var r,n;return a((null==(n=e.response)||null==(r=n.data)?void 0:r.message)||"Login failed")}}),i=(0,r.zD)("auth/register",async(e,t)=>{let{rejectWithValue:a}=t;try{return(await s.R2.register(e)).data}catch(e){var r,n;return a((null==(n=e.response)||null==(r=n.data)?void 0:r.message)||"Registration failed")}}),l=(0,r.zD)("auth/refresh",async(e,t)=>{let{rejectWithValue:a}=t;try{return(await s.R2.refreshToken(e)).data}catch(e){var r,n;return a((null==(n=e.response)||null==(r=n.data)?void 0:r.message)||"Token refresh failed")}}),o=(0,r.Z0)({name:"auth",initialState:{user:null,token:null,refreshToken:null,isAuthenticated:!1,isLoading:!1,error:null},reducers:{logout:e=>{e.user=null,e.token=null,e.refreshToken=null,e.isAuthenticated=!1,e.error=null},clearError:e=>{e.error=null},updateUser:(e,t)=>{e.user&&(e.user={...e.user,...t.payload})}},extraReducers:e=>{e.addCase(n.pending,e=>{e.isLoading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.isLoading=!1,e.user=t.payload.user,e.token=t.payload.token,e.refreshToken=t.payload.refreshToken,e.isAuthenticated=!0,e.error=null}).addCase(n.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload,e.isAuthenticated=!1}).addCase(i.pending,e=>{e.isLoading=!0,e.error=null}).addCase(i.fulfilled,(e,t)=>{e.isLoading=!1,e.user=t.payload.user,e.token=t.payload.token,e.refreshToken=t.payload.refreshToken,e.isAuthenticated=!0,e.error=null}).addCase(i.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(l.fulfilled,(e,t)=>{e.token=t.payload.token,e.refreshToken=t.payload.refreshToken}).addCase(l.rejected,e=>{e.user=null,e.token=null,e.refreshToken=null,e.isAuthenticated=!1})}}),{logout:d,clearError:c,updateUser:u}=o.actions,h=o.reducer},6243:(e,t,a)=>{"use strict";a.d(t,{q:()=>J,M:()=>B});var r=a(6439),s=a(1328),n=a(8091),i=a(52),l=a(4732),o=a(425);let d=(0,r.zD)("users/fetchUsers",async(e,t)=>{let{rejectWithValue:a}=t;try{return(await o.Eo.getUsers(e)).data}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to fetch users")}}),c=(0,r.zD)("users/fetchUser",async(e,t)=>{let{rejectWithValue:a}=t;try{return(await o.Eo.getUser(e)).data}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to fetch user")}}),u=(0,r.zD)("users/updateUser",async(e,t)=>{let{id:a,updates:r}=e,{rejectWithValue:s}=t;try{return(await o.Eo.updateUser(a,r)).data}catch(e){var n,i;return s((null==(i=e.response)||null==(n=i.data)?void 0:n.message)||"Failed to update user")}}),h=(0,r.Z0)({name:"user",initialState:{users:[],currentUser:null,isLoading:!1,error:null},reducers:{setCurrentUser:(e,t)=>{e.currentUser=t.payload},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(d.pending,e=>{e.isLoading=!0,e.error=null}).addCase(d.fulfilled,(e,t)=>{e.isLoading=!1,e.users=t.payload}).addCase(d.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(c.fulfilled,(e,t)=>{e.currentUser=t.payload}).addCase(c.rejected,(e,t)=>{e.error=t.payload}).addCase(u.fulfilled,(e,t)=>{var a;let r=e.users.findIndex(e=>e.id===t.payload.id);-1!==r&&(e.users[r]=t.payload),(null==(a=e.currentUser)?void 0:a.id)===t.payload.id&&(e.currentUser=t.payload)}).addCase(u.rejected,(e,t)=>{e.error=t.payload})}}),{setCurrentUser:p,clearError:g}=h.actions,f=h.reducer,m=(0,r.zD)("tasks/fetchTasks",async(e,t)=>{let{rejectWithValue:a}=t;try{return(await o.ov.getTasks(e)).data}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to fetch tasks")}}),y=(0,r.zD)("tasks/createTask",async(e,t)=>{let{rejectWithValue:a}=t;try{return(await o.ov.createTask(e)).data}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to create task")}}),k=(0,r.zD)("tasks/updateTask",async(e,t)=>{let{id:a,updates:r}=e,{rejectWithValue:s}=t;try{return(await o.ov.updateTask(a,r)).data}catch(e){var n,i;return s((null==(i=e.response)||null==(n=i.data)?void 0:n.message)||"Failed to update task")}}),x=(0,r.zD)("tasks/deleteTask",async(e,t)=>{let{rejectWithValue:a}=t;try{return await o.ov.deleteTask(e),e}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to delete task")}}),v=(0,r.Z0)({name:"tasks",initialState:{tasks:[],currentTask:null,isLoading:!1,error:null,filters:{}},reducers:{setCurrentTask:(e,t)=>{e.currentTask=t.payload},setFilters:(e,t)=>{e.filters=t.payload},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(m.pending,e=>{e.isLoading=!0,e.error=null}).addCase(m.fulfilled,(e,t)=>{e.isLoading=!1,e.tasks=t.payload}).addCase(m.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(y.fulfilled,(e,t)=>{e.tasks.push(t.payload)}).addCase(y.rejected,(e,t)=>{e.error=t.payload}).addCase(k.fulfilled,(e,t)=>{var a;let r=e.tasks.findIndex(e=>e.id===t.payload.id);-1!==r&&(e.tasks[r]=t.payload),(null==(a=e.currentTask)?void 0:a.id)===t.payload.id&&(e.currentTask=t.payload)}).addCase(k.rejected,(e,t)=>{e.error=t.payload}).addCase(x.fulfilled,(e,t)=>{var a;e.tasks=e.tasks.filter(e=>e.id!==t.payload),(null==(a=e.currentTask)?void 0:a.id)===t.payload&&(e.currentTask=null)}).addCase(x.rejected,(e,t)=>{e.error=t.payload})}}),{setCurrentTask:w,setFilters:j,clearError:T}=v.actions,C=v.reducer,b=(0,r.zD)("points/fetchUserPoints",async(e,t)=>{let{rejectWithValue:a}=t;try{return(await o.Ig.getPoints(e)).data}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to fetch points")}}),N=(0,r.zD)("points/fetchPointsHistory",async(e,t)=>{let{rejectWithValue:a}=t;try{return(await o.Ig.getPointsHistory(e)).data}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to fetch points history")}}),A=(0,r.zD)("points/fetchLeaderboard",async(e,t)=>{let{rejectWithValue:a}=t;try{return(await o.Ig.getLeaderboard(e)).data}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to fetch leaderboard")}}),E=(0,r.zD)("points/awardPoints",async(e,t)=>{let{rejectWithValue:a}=t;try{return(await o.Ig.awardPoints(e)).data}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to award points")}}),U=(0,r.Z0)({name:"points",initialState:{userPoints:0,pointsHistory:[],leaderboard:[],isLoading:!1,error:null},reducers:{clearError:e=>{e.error=null},addPointsRecord:(e,t)=>{e.pointsHistory.unshift(t.payload),e.userPoints+=t.payload.points}},extraReducers:e=>{e.addCase(b.pending,e=>{e.isLoading=!0,e.error=null}).addCase(b.fulfilled,(e,t)=>{e.isLoading=!1,e.userPoints=t.payload.totalPoints||0}).addCase(b.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(N.fulfilled,(e,t)=>{e.pointsHistory=t.payload}).addCase(N.rejected,(e,t)=>{e.error=t.payload}).addCase(A.fulfilled,(e,t)=>{e.leaderboard=t.payload}).addCase(A.rejected,(e,t)=>{e.error=t.payload}).addCase(E.fulfilled,(e,t)=>{e.pointsHistory.unshift(t.payload),e.userPoints+=t.payload.points}).addCase(E.rejected,(e,t)=>{e.error=t.payload})}}),{clearError:L,addPointsRecord:R}=U.actions,P=U.reducer,S=(0,r.zD)("notifications/fetchNotifications",async(e,t)=>{let{rejectWithValue:a}=t;try{return(await o.i9.getNotifications(e)).data}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to fetch notifications")}}),z=(0,r.zD)("notifications/markAsRead",async(e,t)=>{let{rejectWithValue:a}=t;try{return await o.i9.markAsRead(e),e}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to mark as read")}}),D=(0,r.zD)("notifications/markAllAsRead",async(e,t)=>{let{rejectWithValue:a}=t;try{return await o.i9.markAllAsRead(e),e}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to mark all as read")}}),F=(0,r.zD)("notifications/deleteNotification",async(e,t)=>{let{rejectWithValue:a}=t;try{return await o.i9.deleteNotification(e),e}catch(e){var r,s;return a((null==(s=e.response)||null==(r=s.data)?void 0:r.message)||"Failed to delete notification")}}),I=(0,r.Z0)({name:"notifications",initialState:{notifications:[],unreadCount:0,isLoading:!1,error:null},reducers:{addNotification:(e,t)=>{e.notifications.unshift(t.payload),t.payload.isRead||(e.unreadCount+=1)},clearError:e=>{e.error=null}},extraReducers:e=>{e.addCase(S.pending,e=>{e.isLoading=!0,e.error=null}).addCase(S.fulfilled,(e,t)=>{e.isLoading=!1,e.notifications=t.payload,e.unreadCount=t.payload.filter(e=>!e.isRead).length}).addCase(S.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(z.fulfilled,(e,t)=>{let a=e.notifications.find(e=>e.id===t.payload);a&&!a.isRead&&(a.isRead=!0,e.unreadCount-=1)}).addCase(z.rejected,(e,t)=>{e.error=t.payload}).addCase(D.fulfilled,e=>{e.notifications.forEach(e=>{e.isRead=!0}),e.unreadCount=0}).addCase(D.rejected,(e,t)=>{e.error=t.payload}).addCase(F.fulfilled,(e,t)=>{let a=e.notifications.findIndex(e=>e.id===t.payload);-1!==a&&(e.notifications[a].isRead||(e.unreadCount-=1),e.notifications.splice(a,1))}).addCase(F.rejected,(e,t)=>{e.error=t.payload})}}),{addNotification:_,clearError:M}=I.actions,K=I.reducer,Y={key:"root",storage:n.A,whitelist:["auth","user"]},H=(0,i.HY)({auth:l.Ay,user:f,task:C,points:P,notification:K}),O=(0,s.rL)(Y,H),B=(0,r.U1)({reducer:O,middleware:e=>e({serializableCheck:{ignoredActions:["persist/PERSIST","persist/REHYDRATE"]}}),devTools:!1}),J=(0,s.GM)(B)},9393:()=>{},9683:(e,t,a)=>{"use strict";a.d(t,{Layout:()=>p});var r=a(5155),s=a(2115),n=a(6874),i=a.n(n),l=a(5695),o=a(2596);let d=e=>{let{children:t,className:a,variant:s="default",hover:n=!1,onClick:i}=e;return(0,r.jsx)("div",{className:(0,o.$)("glass-container",{default:"",card:"glass-card",modal:"p-6 max-w-md mx-auto",sidebar:"h-full"}[s],n?"hover:bg-white/15 hover:scale-[1.02] transition-all duration-300":"",i?"cursor-pointer":"",a),onClick:i,children:t})};var c=a(3590),u=a(3320);let h={advisor:{canCreateTasks:!0,canAssignTasks:!0,canApproveTasks:!0,canManageUsers:!0,canViewAllStats:!0,canDeleteTasks:!0,canModifyPoints:!0},parent:{canCreateTasks:!0,canAssignTasks:!0,canApproveTasks:!0,canManageUsers:!1,canViewAllStats:!0,canDeleteTasks:!1,canModifyPoints:!1},member:{canCreateTasks:!1,canAssignTasks:!1,canApproveTasks:!1,canManageUsers:!1,canViewAllStats:!1,canDeleteTasks:!1,canModifyPoints:!1}},p=e=>{var t,a;let{children:n}=e,{user:o,logout:p}=(0,c.A)(),{addNotification:g}=(0,u.h)(),f=(0,l.usePathname)(),[m,y]=(0,s.useState)(!1),k=async()=>{try{await p(),g({type:"success",message:"已成功退出登录"})}catch(e){g({type:"error",message:"退出登录失败"})}},x=e=>f===e||f.startsWith(e+"/"),v=o&&(null==(t=h[o.role])?void 0:t.canManageUsers);return(0,r.jsx)("div",{className:"min-h-screen p-4",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsx)("header",{className:"mb-8",children:(0,r.jsx)(d,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("img",{src:"/assets/logo.svg",alt:"KD之家",className:"w-10 h-10"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-white",children:"KD之家"}),(0,r.jsx)("p",{className:"text-glass-muted",children:"现代化家务积分管理系统"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,r.jsxs)("nav",{className:"hidden md:flex space-x-4",children:[(0,r.jsx)(i(),{href:"/dashboard",className:"px-3 py-2 rounded-lg transition-colors ".concat(x("/dashboard")?"bg-white/20 text-white":"text-glass hover:text-white hover:bg-white/10"),children:"仪表板"}),(0,r.jsx)(i(),{href:"/tasks",className:"px-3 py-2 rounded-lg transition-colors ".concat(x("/tasks")?"bg-white/20 text-white":"text-glass hover:text-white hover:bg-white/10"),children:"任务"}),(0,r.jsx)(i(),{href:"/leaderboard",className:"px-3 py-2 rounded-lg transition-colors ".concat(x("/leaderboard")?"bg-white/20 text-white":"text-glass hover:text-white hover:bg-white/10"),children:"排行榜"}),(0,r.jsx)(i(),{href:"/profile",className:"px-3 py-2 rounded-lg transition-colors ".concat(x("/profile")?"bg-white/20 text-white":"text-glass hover:text-white hover:bg-white/10"),children:"个人资料"}),v&&(0,r.jsx)(i(),{href:"/admin",className:"px-3 py-2 rounded-lg transition-colors ".concat(x("/admin")?"bg-white/20 text-white":"text-glass hover:text-white hover:bg-white/10"),children:"管理"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>y(!m),className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-white/10 transition-colors",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-primary-500 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white font-semibold text-sm",children:null==o||null==(a=o.username)?void 0:a.charAt(0).toUpperCase()})}),(0,r.jsxs)("div",{className:"hidden sm:block text-left",children:[(0,r.jsx)("p",{className:"text-white text-sm font-medium",children:null==o?void 0:o.username}),(0,r.jsx)("p",{className:"text-glass-muted text-xs",children:null==o?void 0:o.role})]})]}),m&&(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-48 glass-container p-2 z-50",children:[(0,r.jsx)(i(),{href:"/profile",className:"block px-3 py-2 text-glass hover:text-white hover:bg-white/10 rounded-lg transition-colors",onClick:()=>y(!1),children:"个人资料"}),(0,r.jsx)("button",{onClick:()=>{y(!1),k()},className:"w-full text-left px-3 py-2 text-glass hover:text-white hover:bg-white/10 rounded-lg transition-colors",children:"退出登录"})]})]})]})]})})}),(0,r.jsx)("main",{children:n})]})})}},9905:(e,t,a)=>{"use strict";a.d(t,{ProtectedRoute:()=>o});var r=a(5155),s=a(2115),n=a(5695),i=a(3590),l=a(3840);function o(e){let{children:t,requiredRole:a}=e,{user:o,loading:d,isAuthenticated:c}=(0,i.A)(),u=(0,n.useRouter)();return((0,s.useEffect)(()=>{d||c||u.push("/login")},[d,c,u]),d)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)(l.k,{size:"lg"})}):c?a&&(null==o?void 0:o.role)!==a?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"访问被拒绝"}),(0,r.jsx)("p",{className:"text-gray-600",children:"您没有权限访问此页面。"})]})}):(0,r.jsx)(r.Fragment,{children:t}):null}}}]);